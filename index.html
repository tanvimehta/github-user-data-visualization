<html>
<head>
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<link href='http://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Josefin+Sans:400,600,700|Montserrat|Raleway&effect=canvas-print|stonewash' rel='stylesheet' type='text/css'>
<style>
/* put a border around the svg element so we can see the coordinate system better. */
body { 

font-family: 'Raleway', sans-serif;
text-align:center;
margin:50 auto;
font-weight: 300;
background-color: #F5F5F5;

}

.axis{stroke-width:1px;}

h1{font-weight:700;
  font-size: 24pt;
  margin-bottom: 5pt;
}

div { margin: 40px; }

path{
   stroke-width:2;
   fill:transparent;
   stroke:#333;
}

.tick{
  font-size: 10pt;
  font-weight:400;
}

#wrapper {
  width: 1080px;
  margin: 0 auto;
  background-color:#FFFAFA;
}

#canvas{
  width:800px;
  float: left; 
}

#legend {
  width: 200px;
  float: left;
  height: 800px;
}

.clear {
  clear: both;
}

p {
  width:800px;
  font-size: 18px;
  margin: 20px auto;
}

#mapC, #mapJava, #mapJS {
  margin: 0 auto;
}

</style>
</head>

<body>

<h1 class="font-effect-canvas-print">Popularity of GitHub Repository Programming Languages from 2012 to 2014</h1>
<p>
The chart shows the ten most popular programming languages used by GitHub open source repositories from 2012 to 2014. We represent the data in the form of percentage of total open source collaborators to better understand the trend for each language.
</p>



<div id="wrapper">
  <div id="canvas"></div>
  <svg id="legend" height="800" width="200">
    <circle cx="10" cy="165" r="5" fill="red"></circle>
    <circle cx="10" cy="390" r="5" fill="tomato"></circle>
    <circle cx="10" cy="430" r="5" fill="orange"></circle>
    <circle cx="10" cy="490" r="5" fill="gold"></circle>
    <circle cx="10" cy="510" r="5" fill="yellow"></circle>
    <circle cx="10" cy="550" r="5" fill="lime"></circle>
    <circle cx="10" cy="575" r="5" fill="green"></circle>
    <circle cx="10" cy="610" r="5" fill="blue"></circle>
    <circle cx="10" cy="630" r="5" fill="purple"></circle>
    <circle cx="10" cy="650" r="5" fill="black"></circle>

    <text text-anchor="middle" x="60" y="170" fill="black" font-family="Lato">JavaScript</text>
    <text text-anchor="middle" x="40" y="395" fill="black" font-family="Lato">Java</text>
    <text text-anchor="middle" x="50" y="435" fill="black" font-family="Lato">Python</text>
    <text text-anchor="middle" x="40" y="495" fill="black" font-family="Lato">PHP</text>
    <text text-anchor="middle" x="42" y="515" fill="black" font-family="Lato">Ruby</text>
    <text text-anchor="middle" x="40" y="555" fill="black" font-family="Lato">C++</text>
    <text text-anchor="middle" x="31" y="580" fill="black" font-family="Lato">C</text>
    <text text-anchor="middle" x="36" y="615" fill="black" font-family="Lato">C#</text>
    <text text-anchor="middle" x="43" y="635" fill="black" font-family="Lato">Shell</text>
    <text text-anchor="middle" x="68" y="655" fill="black" font-family="Lato">Objective-C</text>
  </svg>
  <div class="clear"></div>

</div>


<script>

var margin = {top: 50, right: 50, bottom: 50, left: 50};
var width = 800 - margin.left - margin.right;
var height = 700 - margin.top - margin.bottom;

var svg = d3.select("#canvas").append("svg")
    .attr("width", width + margin.left + margin.right + 100)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

//var labels = ["2012 Jan-Jun", "2012 Jul-Dec", "2013 Jan-Jun", "2013 Jul-Dec", "2014 Jan-Jun", "2014 Jul-Dec"];
//var xScale = d3.scale.ordinal().domain(labels).range(labels).rangeRoundBands([0, width]);
var xScale = d3.scale.linear().domain([0,5]).range([0, width]); 
var xAxis = d3.svg.axis().scale(xScale).orient("bottom").ticks(6);

var yScale = d3.scale.linear().domain([0,20]).range([height, 0]); 
var yAxis = d3.svg.axis().scale(yScale).orient("left");


svg.append("g")
  .attr("class", "y axis")
  .call(yAxis)
  .append("text")
  .attr("class", "label")
  .attr("x", 40)
  .attr("y", -20)
  .attr("transform", "rotate(90)")
  .style("text-anchor", "end")
  .text("Percentage");

svg.append("g")
  .attr("class", "x axis")
  .attr("transform", "translate(0," + height + ")")
  .call(xAxis)
  .append("text")
  .attr("class", "label")
  .attr("x", width + 30)
  .attr("y", -10)
  .style("text-anchor", "end")
  .text("Year");



d3.csv("percentage.csv", function(error,data) {
  d3.select("#canvas").append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  data.forEach(function(entry){
   
    svg.append("circle")
      .attr("cx", xScale(parseInt(entry.period)))
      .attr("cy", yScale(parseFloat(entry.percentage*100))).attr("r", 8).attr("fill", selectColor(entry.repository_language)).attr("opacity", 0.5);

    function getNext(entry) {
      for (var i = 0; i < data.length; i++) {
        var str1 = data[i].repository_language;
        var str2 = entry.repository_language;
        var period1 = parseInt(data[i].period);
        var period2 = parseInt(entry.period);
        if ((str1 == str2) && (period1 == (period2 + 1))) {
          result = parseFloat(data[i].percentage)*100;
        }
      }
      return result;
    }

    if (entry.period < 5) {
      svg.append("line").attr("style", "stroke: "+selectColor(entry.repository_language)+"; stroke-width: 3px; opacity: 0.5;")
      .attr("x1", xScale(parseInt(entry.period)))
      .attr("y1", yScale(parseFloat(entry.percentage * 100)))
      .attr("x2", xScale(parseInt(entry.period) + 1))
      .attr("y2", yScale(getNext(entry)));
    }
    
  });

});

function selectColor(language) {
  switch (language) {
      case "JavaScript":
          return "red"
          break;
      case "Java":
          return "tomato"
          break;
      case "Python":
          return "orange";
          break;
      case "PHP":
          return "gold";
          break;
      case "Ruby":
          return "yellow"
          break;
      case "C++":
          return "lime";
          break;
      case "C":
          return "green";
          break;
      case "C#":
          return "blue"
          break;
      case "Shell":
          return "purple";
          break;
      case "Objective-C":
          return "black";
          break;
    }
}

</script>


<h1> Project 1 - Programming Language Popularity </h1>
<p> The charts below represent the popularity of 3 programming languages in the year 2014 - JavaScript, Java, C by location. </p>
<div id = "map1"></div>
<script>
 var mapwidth = 960, mapheight = 550;
 var projection = d3.geo.equirectangular();
 var path = d3.geo.path().projection(projection);
 var svgMap = d3.select("#map1").append("svg")
                  .attr("width", mapwidth).attr("height", mapheight);
 var gMap = svgMap.append("g");
 var worldObject;
  d3.json("world-50m.json", function(error, world){
      worldObject = world;
      if(error){console.log(error);}

      var countries = topojson.feature(world, world.objects.countries).features;
      countries.forEach(function(country){
        gMap.append("path").attr("d", path(country))
         .style("fill", "#ccc")
         .style("stroke", "#888")
         .style("stroke-width", 1);
      });
    });

</script>

<p> <b>JavaScript distribution</b></br>As seen in the previous chart, we conclude that JavaScript is the most popular programming language within the Github community. The map below suggests that JavaScript is used extensively throughout the world. Although, within the United States, JavaScript is more popular on the East Coast than the West Coast.</p>
<div id ="mapJS"></div>
<script>
    var mapwidth = 960, mapheight = 550;
    var projection = d3.geo.equirectangular();
    var path = d3.geo.path().projection(projection);
    var svgMapJS = d3.select("#mapJS").append("svg")
                  .attr("width", mapwidth).attr("height", mapheight);
    var gMapJS = svgMapJS.append("g");
    var worldObjectJS;
    d3.json("world-50m.json", function(error, world){
        worldObjectJS = world;
        if(error){console.log(error);}

        var countries = topojson.feature(world, world.objects.countries).features;
        countries.forEach(function(country){
            gMapJS.append("path").attr("d", path(country))
             .style("fill", "#ccc")
             .style("stroke", "#888")
             .style("stroke-width", 1);
        });
        d3.csv("400_JS_occ.csv", function(error, csvdata){
            if(error){
                console.log(error);
            }

            var occur = new Array();
            
            for(var i = 0; i < csvdata.length; i++){
                var occur_number = parseInt(csvdata[i].occurences);
                occur.push(occur_number);
            }
            var max_occur = d3.max(occur);
            var min_occur = d3.min(occur);
            var radius_scale = d3.scale.linear()
                .domain([min_occur, max_occur])
                .range([0, 20]);
            
            for(var i = 0; i < csvdata.length; i++){
                var lon = csvdata[i].longitude;
                var lat = csvdata[i].latitude;
                var occ = csvdata[i].occurences;
                if(lat == "" || lon == "" || occ == ""){
                    continue;
                }
                var lon_number = parseFloat(lon);
                var lat_number = parseFloat(lat);
                var occur_number = parseInt(occ);
                var radius = radius_scale(occur_number) + 7;
                var coordiantes2 = projection([lat_number, lon_number]);
                gMapJS.append("circle").attr("cx", coordiantes2[0])
                    .attr("cy", coordiantes2[1])
                    .attr("r", radius)
                    .style("fill", "#0101DF")
                    .style("opacity", 0.6);
                gMap.append("circle").attr("cx", coordiantes2[0])
                    .attr("cy", coordiantes2[1])
                    .attr("r", radius)
                    .style("fill", "#7570b3")
                    .style("opacity", 0.6);
        }
    });
});
</script>
 <p><b>Java distribution</b></br>Being the second most popular, Java is also used widely throughout the world. The interesting distincion between the usage patterns for JavaScript and Java are seen in United States and South America. While the JavaScript users are concentrated on the coasts, Java users are spread uniformly throughout the United States. Furthermore, Java is seen to be more popular in South America than JavaScript.</p>
<div id ="mapJava"></div>
<script>
    var mapwidth = 960, mapheight = 550;
    var projection = d3.geo.equirectangular();
    var path = d3.geo.path().projection(projection);
    var svgMapJava = d3.select("#mapJava").append("svg")
                  .attr("width", mapwidth).attr("height", mapheight);
    var gMapJava = svgMapJava.append("g");
    var worldObjectJava;
    d3.json("world-50m.json", function(error, world){
        worldObjectJava = world;
        if(error){console.log(error);}

        var countries = topojson.feature(world, world.objects.countries).features;
        countries.forEach(function(country){
            gMapJava.append("path").attr("d", path(country))
             .style("fill", "#ccc")
             .style("stroke", "#888")
             .style("stroke-width", 1);
        });

        d3.csv("400_Java_occ.csv", function(error, csvdata){
        if(error){
            console.log(error);
        }

         var occur = new Array();
            
        for(var i = 0; i < csvdata.length; i++){
            var occur_number = parseInt(csvdata[i].occurences);
            occur.push(occur_number);
        }
        var max_occur = d3.max(occur);
        var min_occur = d3.min(occur);
        var radius_scale = d3.scale.linear()
            .domain([min_occur, max_occur])
            .range([0, 20]);
        
        for(var i = 0; i < csvdata.length; i++){
            var lon = csvdata[i].longitude;
            var lat = csvdata[i].latitude;
            var occ = csvdata[i].occurences;
            if(lat == "" || lon == "" || occ == ""){
                continue;
            }
            var lon_number = parseFloat(lon);
            var lat_number = parseFloat(lat);
            var occur_number = parseInt(occ);
            var radius = radius_scale(occur_number) + 7;
            var coordiantes1 = projection([lat_number, lon_number]);
            gMapJava.append("circle").attr("cx", coordiantes1[0])
                .attr("cy", coordiantes1[1])
                .attr("r", radius)
                .style("fill", "#0101DF")
                .style("opacity", 0.6);
            gMap.append("circle").attr("cx", coordiantes1[0])
                .attr("cy", coordiantes1[1])
                .attr("r", radius)
                .style("fill", "#F5AEDA")
                .style("opacity", 0.6);
        }
    });
});  
</script>
    

<p><b>C distribution</b></br>The usage pattern for C suggests that while it is not concentrated in any specific region, it is used still used in small numbers throughout the world.</p>
<div id ="mapC"></div>
<script>
    var mapwidth = 960, mapheight = 550;
    var projection = d3.geo.equirectangular();
    var path = d3.geo.path().projection(projection);
    var svgMapC = d3.select("#mapC").append("svg")
                  .attr("width", mapwidth).attr("height", mapheight);
    var gMapC = svgMapC.append("g");
    var worldObjectC;
    d3.json("world-50m.json", function(error, world){
      worldObjectC = world;
      if(error){console.log(error);}

      var countries = topojson.feature(world, world.objects.countries).features;
      countries.forEach(function(country){
        gMapC.append("path").attr("d", path(country))
         .style("fill", "#ccc")
         .style("stroke", "#888")
         .style("stroke-width", 1);
      });

         d3.csv("400_C_occ.csv", function(error, csvdata){
        if(error){
            console.log(error);
        }

         var occur = new Array();
            
        for(var i = 0; i < csvdata.length; i++){
            var occur_number = parseInt(csvdata[i].occurences);
            occur.push(occur_number);
        }
        var max_occur = d3.max(occur);
        var min_occur = d3.min(occur);
        var radius_scale = d3.scale.linear()
            .domain([min_occur, max_occur])
            .range([0, 20]);
        
        for(var i = 0; i < csvdata.length; i++){
              var lon = csvdata[i].longitude;
            var lat = csvdata[i].latitude;
            var occ = csvdata[i].occurences;
            if(lat == "" || lon == "" || occ == ""){
                continue;
            }
            var lon_number = parseFloat(lon);
            var lat_number = parseFloat(lat);
            var occur_number = parseInt(occ);
            var radius = radius_scale(occur_number) + 7;
            var coordiantes = projection([lat_number, lon_number]);
            gMapC.append("circle").attr("cx", coordiantes[0])
                .attr("cy", coordiantes[1])
                .attr("r", radius)
                .style("fill", "#0101DF")
                .style("opacity", 0.6);
            gMap.append("circle").attr("cx", coordiantes[0])
                .attr("cy", coordiantes[1])
                .attr("r", radius)
                .style("fill", "#1b9e77")
                .style("opacity", 0.6);
        }
    });
});
</script>




</body>
</html>